{
  "priority": 100,
  "request": {
    "method": "POST",
    "url": "/morpheus/scan"
  },
  "response": {
    "status": 202
  },
  "serveEventListeners": [
    {
      "name": "webhook",
      "parameters": {
        "method": "POST",
        "url": "http://localhost:8080/reports",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\n  \"input\": {\n    \"scan\": {\n      \"id\": \"{{jsonPath originalRequest.body '$.scan.id'}}\",\n      \"type\": null,\n      \"started_at\": \"{{now}}\",\n      \"completed_at\": \"{{now offset='1 seconds'}}\",\n      \"vulns\": [\n        {\n          \"vuln_id\": \"CVE-2024-5037\"\n        }\n      ]\n    },\n    \"image\": {\n      \"name\": \"registry.redhat.io/openshift4/ose-telemeter\",\n      \"tag\": \"sha256:240ed6acb75e91f7af2b0bc8951c8f3ce05d32d7308dfb8d452ff924691637ae\",\n      \"source_info\": [\n        {\n          \"type\": \"code\",\n          \"git_repo\": \"https://github.com/openshift/telemeter\",\n          \"ref\": \"1f7268163afc74f9f3c1ff89d8c0149760694e6c\",\n          \"include\": [\n            \"**/*.go\",\n            \"**/*.py\",\n            \"*.dockerfile\",\n            \"*.dockerignore\",\n            \"*.env\",\n            \"*.json\",\n            \"*.sh\",\n            \"*.yaml\",\n            \"*.yml\",\n            \"Dockerfile*\",\n            \"Pipfile\",\n            \"Pipfile.lock\",\n            \"conf.d/**/*\",\n            \"config/**/*\",\n            \"docker-compose.*.yml\",\n            \"docker-compose.yml\",\n            \"go.*\",\n            \"pyproject.toml\",\n            \"requirements.txt\",\n            \"scripts/**/*\",\n            \"setup.cfg\",\n            \"setup.py\"\n          ],\n          \"exclude\": [\n            \"*.pyc\",\n            \"*.pyd\",\n            \"*.pyo\",\n            \".github/**/*\",\n            \".mypy_cache/**/*\",\n            \".pytest_cache/**/*\",\n            \".venv/**/*\",\n            \"__pycache__/**/*\",\n            \"build/**/*\",\n            \"dist/**/*\",\n            \"env/**/*\",\n            \"test/**/*\",\n            \"test/**/*\",\n            \"tests/**/*\",\n            \"venv/**/*\"\n          ]\n        },\n        {\n          \"type\": \"doc\",\n          \"git_repo\": \"https://github.com/openshift/telemeter\",\n          \"ref\": \"1f7268163afc74f9f3c1ff89d8c0149760694e6c\",\n          \"include\": [\n            \"**/*.md\",\n            \"docs/**/*.rst\"\n          ],\n          \"exclude\": []\n        }\n      ],\n      \"sbom_info\": {\n        \"_type\": \"manual\",\n        \"packages\": [\n          {\n            \"name\": \"acl\",\n            \"version\": \"2.2.53-3.el8\",\n            \"system\": \"rpm\"\n          },\n          {\n            \"name\": \"audit-libs\",\n            \"version\": \"3.1.2-1.el8\",\n            \"system\": \"rpm\"\n          }\n        ]\n      }\n    }\n  },\n  \"info\": {\n    \"vdb\": {\n      \"code_vdb_path\": \"/morpheus-data/vdbs/code/50d7ac225a030a44\",\n      \"doc_vdb_path\": \"/morpheus-data/vdbs/doc/65782947a7dcc2db\"\n    },\n    \"intel\": [\n      {\n        \"vuln_id\": \"CVE-2024-5037\",\n        \"ghsa\": {\n          \"ghsa_id\": \"GHSA-gc8r-pxj9-hhx3\",\n          \"cve_id\": \"CVE-2024-5037\",\n          \"summary\": \"A flaw was found in OpenShift's Telemeter. If certain conditions are in place, an attacker can...\",\n          \"description\": \"A flaw was found in OpenShift's Telemeter. If certain conditions are in place, an attacker can use a forged token to bypass the issue (\\\"iss\\\") check during JSON web token (JWT) authentication.\",\n          \"severity\": \"high\",\n          \"vulnerabilities\": [],\n          \"cvss\": {\n            \"score\": 7.5,\n            \"vector_string\": \"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N\"\n          },\n          \"cwes\": [\n            {\n              \"cwe_id\": \"CWE-290\",\n              \"name\": \"Authentication Bypass by Spoofing\"\n            }\n          ],\n          \"url\": \"https://api.github.com/advisories/GHSA-gc8r-pxj9-hhx3\",\n          \"html_url\": \"https://github.com/advisories/GHSA-gc8r-pxj9-hhx3\",\n          \"type\": \"unreviewed\",\n          \"repository_advisory_url\": null,\n          \"source_code_location\": \"\",\n          \"identifiers\": [\n            {\n              \"value\": \"GHSA-gc8r-pxj9-hhx3\",\n              \"type\": \"GHSA\"\n            },\n            {\n              \"value\": \"CVE-2024-5037\",\n              \"type\": \"CVE\"\n            }\n          ],\n          \"references\": [\n            \"https://nvd.nist.gov/vuln/detail/CVE-2024-5037\",\n            \"https://github.com/kubernetes/kubernetes/pull/123540\",\n            \"https://access.redhat.com/security/cve/CVE-2024-5037\",\n            \"https://bugzilla.redhat.com/show_bug.cgi?id=2272339\",\n            \"https://github.com/openshift/telemeter/blob/a9417a6062c3a31ed78c06ea3a0613a52f2029b2/pkg/authorize/jwt/client_authorizer.go#L78\",\n            \"https://access.redhat.com/errata/RHSA-2024:4151\",\n            \"https://access.redhat.com/errata/RHSA-2024:4156\",\n            \"https://access.redhat.com/errata/RHSA-2024:4329\",\n            \"https://access.redhat.com/errata/RHSA-2024:4484\",\n            \"https://access.redhat.com/errata/RHSA-2024:5200\",\n            \"https://github.com/advisories/GHSA-gc8r-pxj9-hhx3\"\n          ],\n          \"published_at\": \"2024-06-05T18:30:37Z\",\n          \"updated_at\": \"2024-08-19T18:32:03Z\",\n          \"github_reviewed_at\": null,\n          \"nvd_published_at\": \"2024-06-05T18:15:11Z\",\n          \"withdrawn_at\": null,\n          \"credits\": [],\n          \"cvss_severities\": {\n            \"cvss_v3\": {\n              \"vector_string\": \"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N\",\n              \"score\": 7.5\n            },\n            \"cvss_v4\": {\n              \"vector_string\": null,\n              \"score\": 0\n            }\n          },\n          \"epss\": {\n            \"percentage\": 0.00142,\n            \"percentile\": 0.50558\n          }\n        },\n        \"nvd\": {\n          \"cve_id\": \"CVE-2024-5037\",\n          \"cve_description\": \"A flaw was found in OpenShift's Telemeter. If certain conditions are in place, an attacker can use a forged token to bypass the issue (\\\"iss\\\") check during JSON web token (JWT) authentication.\",\n          \"cvss_vector\": \"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N\",\n          \"cwe_name\": \"CWE-290: Authentication Bypass by Spoofing (4.15)\",\n          \"cwe_description\": \"This attack-focused weakness is caused by incorrectly implemented authentication schemes that are subject to spoofing attacks.\",\n          \"cwe_extended_description\": null,\n          \"configurations\": [\n            {\n              \"package\": \"openshift_container_platform\",\n              \"system\": null,\n              \"versionStartExcluding\": null,\n              \"versionEndExcluding\": null,\n              \"versionStartIncluding\": \"4.0\",\n              \"versionEndIncluding\": \"4.0\"\n            },\n            {\n              \"package\": \"openshift_distributed_tracing\",\n              \"system\": null,\n              \"versionStartExcluding\": null,\n              \"versionEndExcluding\": null,\n              \"versionStartIncluding\": \"2.0\",\n              \"versionEndIncluding\": \"2.0\"\n            }\n          ],\n          \"vendor_names\": [\n            \"Redhat\"\n          ]\n        },\n        \"rhsa\": {\n          \"bugzilla\": {\n            \"description\": \"openshift/telemeter: iss check during JWT authentication can be bypassed\",\n            \"id\": \"2272339\",\n            \"url\": \"https://bugzilla.redhat.com/show_bug.cgi?id=2272339\"\n          },\n          \"details\": [\n            \"A flaw was found in OpenShift's Telemeter. If certain conditions are in place, an attacker can use a forged token to bypass the issue (\\\"iss\\\") check during JSON web token (JWT) authentication.\",\n            \"A flaw was found in OpenShift's Telemeter. If certain conditions are in place, an attacker can use a forged token to bypass the issue (\\\"iss\\\") check during JSON web token (JWT) authentication.\"\n          ],\n          \"statement\": null,\n          \"package_state\": [\n            {\n              \"product_name\": \"Logging Subsystem for Red Hat OpenShift\",\n              \"fix_state\": \"Not affected\",\n              \"package_name\": \"openshift-logging/opa-openshift-rhel9\",\n              \"cpe\": \"cpe:/a:redhat:logging:5\"\n            },\n            {\n              \"product_name\": \"Red Hat OpenShift distributed tracing 2\",\n              \"fix_state\": \"Affected\",\n              \"package_name\": \"rhosdt/tempo-gateway-opa-rhel8\",\n              \"cpe\": \"cpe:/a:redhat:openshift_distributed_tracing:2\"\n            }\n          ],\n          \"upstream_fix\": null,\n          \"threat_severity\": \"Important\",\n          \"public_date\": \"2024-06-05T17:51:00Z\",\n          \"cvss3\": {\n            \"cvss3_base_score\": \"7.5\",\n            \"cvss3_scoring_vector\": \"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N\",\n            \"status\": \"verified\"\n          },\n          \"cwe\": \"CWE-290\",\n          \"affected_release\": [\n            {\n              \"product_name\": \"Red Hat OpenShift Container Platform 4.12\",\n              \"release_date\": \"2024-08-19T00:00:00Z\",\n              \"advisory\": \"RHSA-2024:5200\",\n              \"cpe\": \"cpe:/a:redhat:openshift:4.12::el8\",\n              \"package\": \"openshift4/ose-telemeter:v4.12.0-202408071159.p0.gc9592de.assembly.stream.el8\"\n            },\n            {\n              \"product_name\": \"Red Hat OpenShift Container Platform 4.13\",\n              \"release_date\": \"2024-07-17T00:00:00Z\",\n              \"advisory\": \"RHSA-2024:4484\",\n              \"cpe\": \"cpe:/a:redhat:openshift:4.13::el8\",\n              \"package\": \"openshift4/ose-telemeter:v4.13.0-202407081338.p0.g0634a6d.assembly.stream.el8\"\n            },\n            {\n              \"product_name\": \"Red Hat OpenShift Container Platform 4.14\",\n              \"release_date\": \"2024-07-11T00:00:00Z\",\n              \"advisory\": \"RHSA-2024:4329\",\n              \"cpe\": \"cpe:/a:redhat:openshift:4.14::el8\",\n              \"package\": \"openshift4/ose-telemeter:v4.14.0-202407021509.p0.g1f72681.assembly.stream.el8\"\n            },\n            {\n              \"product_name\": \"Red Hat OpenShift Container Platform 4.15\",\n              \"release_date\": \"2024-07-02T00:00:00Z\",\n              \"advisory\": \"RHSA-2024:4151\",\n              \"cpe\": \"cpe:/a:redhat:openshift:4.15::el9\",\n              \"package\": \"openshift4/ose-telemeter-rhel9:v4.15.0-202406200537.p0.g14489f7.assembly.stream.el9\"\n            },\n            {\n              \"product_name\": \"Red Hat OpenShift Container Platform 4.16\",\n              \"release_date\": \"2024-07-03T00:00:00Z\",\n              \"advisory\": \"RHSA-2024:4156\",\n              \"cpe\": \"cpe:/a:redhat:openshift:4.16::el9\",\n              \"package\": \"openshift4/ose-telemeter-rhel9:v4.16.0-202406200537.p0.gc1ecd10.assembly.stream.el9\"\n            }\n          ],\n          \"references\": [\n            \"https://www.cve.org/CVERecord?id=CVE-2024-5037\\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-5037\\nhttps://github.com/kubernetes/kubernetes/pull/123540\\nhttps://github.com/openshift/telemeter/blob/a9417a6062c3a31ed78c06ea3a0613a52f2029b2/pkg/authorize/jwt/client_authorizer.go#L78\"\n          ],\n          \"name\": \"CVE-2024-5037\",\n          \"csaw\": false\n        },\n        \"ubuntu\": {\n          \"description\": null,\n          \"notes\": null,\n          \"priority\": null,\n          \"ubuntu_description\": null\n        },\n        \"epss\": {\n          \"epss\": 0.00142,\n          \"percentile\": 0.50794,\n          \"date\": \"2024-10-28\",\n          \"cve\": \"CVE-2024-5037\"\n        }\n      }\n    ],\n    \"sbom\": {\n      \"packages\": [\n        {\n          \"name\": \"acl\",\n          \"version\": \"2.2.53-3.el8\",\n          \"system\": \"rpm\"\n        },\n        {\n          \"name\": \"audit-libs\",\n          \"version\": \"3.1.2-1.el8\",\n          \"system\": \"rpm\"\n        }\n      ]\n    },\n    \"vulnerable_dependencies\": [\n      {\n        \"vuln_id\": \"CVE-2024-5037\",\n        \"vulnerable_sbom_packages\": []\n      }\n    ]\n  },\n  \"output\": [\n    {\n      \"vuln_id\": \"CVE-2024-5037\",\n      \"checklist\": [\n        {\n          \"input\": \"Check SBOM and dependencies for vulnerability.\",\n          \"response\": \"The VulnerableDependencyChecker did not find any vulnerable packages or dependencies in the SBOM.\"\n        }\n      ],\n      \"summary\": \"The VulnerableDependencyChecker did not find any vulnerable packages or dependencies in the SBOM.\",\n      \"justification\": {\n        \"label\": \"code_not_present\",\n        \"reason\": \"No vulnerable packages or dependencies were detected in the SBOM.\",\n        \"status\": \"FALSE\"\n      }\n    }\n  ]\n}"
      }
    }
  ]
}